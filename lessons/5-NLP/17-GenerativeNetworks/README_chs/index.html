<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../../img/favicon.ico" />
    <title>生成网络 - 人工智能初学者课程</title>
    <link rel="stylesheet" href="../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u751f\u6210\u7f51\u7edc";
        var mkdocs_page_input_path = "lessons/5-NLP/17-GenerativeNetworks/README_chs.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../.." class="icon icon-home"> 人工智能初学者课程
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../../README_chs/">课程介绍</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">课程设置</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/for-teachers_chs/">给教育者</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/how-to-run_chs/">如何运行代码</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/setup_chs/">开始使用这个课程</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">人工智能简介</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../1-Intro/README_chs/">人工智能简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../1-Intro/assignment_chs/">游戏开发马拉松</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">知识表示与专家系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../2-Symbolic/README_chs/">知识表示与专家系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../2-Symbolic/assignment_chs/">构建一个本体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">神经网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../3-NeuralNetworks/README_chs/">神经网络介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../3-NeuralNetworks/03-Perceptron/README_chs/">神经网络入门：感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../3-NeuralNetworks/04-OwnFramework/README_chs/">神经网络介绍. 多层感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../3-NeuralNetworks/05-Frameworks/README_chs/">神经网络框架</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">计算机视觉</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/06-IntroCV/README_chs/">计算机视觉简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >卷积神经网络</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../4-ComputerVision/07-ConvNets/CNN_Architectures_chs/">著名的 CNN 架构</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../4-ComputerVision/07-ConvNets/README_chs/">卷积神经网络</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >迁移学习</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../4-ComputerVision/08-TransferLearning/README_chs/">预训练网络和迁移学习</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../4-ComputerVision/08-TransferLearning/TrainingTricks_chs/">深度学习训练技巧</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/09-Autoencoders/README_chs/">自动编码器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/10-GANs/README_chs/">生成对抗网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/11-ObjectDetection/README_chs/">目标检测</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/12-Segmentation/README_chs/">分割</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自然语言处理</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../13-TextRep/README_chs/">将文本表示为张量</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../14-Embeddings/README_chs/">嵌入</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../15-LanguageModeling/README_chs/">语言建模</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../16-RNN/README_chs/">循环神经网络</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">生成网络</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">课前测验</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">✍️ 练习：生成网络</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_4">软文本生成和温度</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_5">结论</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_6">🚀 挑战</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_7">课后测验</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_8">复习与自学</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_9">作业</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../18-Transformers/READMEtransformers_chs">注意机制和Transformer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../19-NER/README_chs/">命名实体识别</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../20-LangModels/READMELargeLang_chs">预训练大语言模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他技术</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/21-GeneticAlgorithms/README_chs/">遗传算法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/22-DeepRL/README_chs/">深度强化学习</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/23-MultiagentSystems/README_chs/">多智能体系统</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">AI伦理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../7-Ethics/README_chs/">道德与负责任的人工智能</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">多模态网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../X-Extras/X1-MultiModal/README_chs/">多模态网络</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../..">人工智能初学者课程</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">自然语言处理</li>
      <li class="breadcrumb-item active">生成网络</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">生成网络</h1>
<h2 id="_2"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/117">课前测验</a></h2>
<p>循环神经网络（RNNs）及其门控单元变体，例如长短期记忆单元（LSTMs）和门控循环单元（GRUs），提供了一种语言建模机制，因为它们可以学习单词排序并为序列中的下一个单词提供预测。这使我们能够使用RNN进行<strong>生成任务</strong>，例如普通文本生成、机器翻译，甚至图片描述。</p>
<blockquote>
<p>✅ 想想在你打字时从生成任务（如文本完成）中受益的所有情形。研究一下你喜欢的应用程序，看看它们是否利用了RNN。</p>
</blockquote>
<p>在我们在前一单元中讨论的RNN架构中，每个RNN单元都生成下一个隐藏状态作为输出。然而，我们也可以为每个循环单元添加另一个输出，这将允许我们输出一个<strong>序列</strong>（该序列长度等于原始序列）。此外，我们可以使用不在每一步接受输入的RNN单元，只需接受一些初始状态向量，然后生成一系列输出。</p>
<p>这允许不同的神经架构，如下图所示：</p>
<p><img alt="显示常见循环神经网络模式的图片" src="../images/unreasonable-effectiveness-of-rnn.jpg" /></p>
<blockquote>
<p>图片来自博文 <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">循环神经网络的无限有效性</a> 作者 <a href="http://karpathy.github.io/">Andrej Karpaty</a></p>
</blockquote>
<ul>
<li><strong>一对一</strong>是一个传统的神经网络，具有一个输入和一个输出</li>
<li><strong>一对多</strong>是一种生成架构，接受一个输入值，并生成一系列输出值。例如，如果我们想训练一个<strong>图像描述</strong>网络，它将生成图片的文本描述，我们可以将图片作为输入，通过CNN获得其隐藏状态，然后让一个循环链逐字生成描述</li>
<li><strong>多对一</strong>对应于我们在前一单元中描述的RNN架构，如文本分类</li>
<li><strong>多对多</strong>或<strong>序列对序列</strong>对应于任务如<strong>机器翻译</strong>，其中我们先有RNN将输入序列的所有信息收集到隐藏状态中，然后另一个RNN链将该状态展开为输出序列。</li>
</ul>
<p>在本单元中，我们将专注于帮助我们生成文本的简单生成模型。为了简化，我们将使用字符级别的标记化。</p>
<p>我们将训练这个RNN一步步生成文本。在每一步，我们将获取长度为<code>nchars</code>的字符序列，并要求网络为每个输入字符生成下一个输出字符：</p>
<p><img alt="显示生成单词'HELLO'的示例RNN的图片" src="../images/rnn-generate.png" /></p>
<p>在生成文本（推理过程中），我们从一些<strong>提示</strong>开始，将其传递通过RNN单元以生成其中间状态，然后从该状态开始生成。我们一次生成一个字符，并将状态和生成的字符传递给另一个RNN单元以生成下一个字符，直到生成足够的字符。</p>
<p><img alt="显示生成单词'HELLO'的示例RNN的图片" src="../images/rnn-generate-inf.png" /></p>
<blockquote>
<p>作者提供的图片</p>
</blockquote>
<h2 id="_3">✍️ 练习：生成网络</h2>
<p>在以下笔记本中继续学习：</p>
<ul>
<li><a href="../GenerativePyTorch.ipynb">使用PyTorch的生成网络</a></li>
<li><a href="../GenerativeTF.ipynb">使用TensorFlow的生成网络</a></li>
</ul>
<h2 id="_4">软文本生成和温度</h2>
<p>每个RNN单元的输出是字符的概率分布。如果我们始终选择概率最高的字符作为生成文本的下一个字符，文本通常可能会在相同的字符序列之间“循环”反复，如下例所示：</p>
<pre><code>today of the second the company and a second the company ...
</code></pre>
<p>然而，如果我们查看下一个字符的概率分布，可能几个最高概率之间的差异并不大，例如一个字符的概率可以是0.2，另一个是0.19，等等。例如，当寻找序列'<em>play</em>'的下一个字符时，下一个字符可以同样可能是空格或<strong>e</strong>（如单词<em>player</em>）。</p>
<p>这使我们得出结论：选择概率较高的字符并不总是“公平的”，因为选择概率第二高的字符仍然可能会导致有意义的文本。更明智的方法是从网络输出给出的概率分布中<strong>抽样</strong>字符。我们还可以使用一个参数，<strong>温度</strong>，来平滑概率分布，以便在我们希望增加更多随机性或希望更多地坚持最高概率字符时加以调整。</p>
<p>探索上述笔记本中如何实现这种软文本生成。</p>
<h2 id="_5">结论</h2>
<p>尽管文本生成本身可能有用，但主要的好处来自于能够使用RNN根据一些初始特征向量生成文本。例如，文本生成用作机器翻译的一部分（序列到序列，在这种情况下状态向量来自<em>编码器</em>，用于生成或<em>解码</em>原文），或生成图像的文本描述（在这种情况下特征向量来自CNN提取器）。</p>
<h2 id="_6">🚀 挑战</h2>
<p>在Microsoft Learn上上这方面的课程</p>
<ul>
<li>使用<a href="https://docs.microsoft.com/learn/modules/intro-natural-language-processing-pytorch/6-generative-networks/?WT.mc_id=academic-77998-cacaste">PyTorch</a>/<a href="https://docs.microsoft.com/learn/modules/intro-natural-language-processing-tensorflow/5-generative-networks/?WT.mc_id=academic-77998-cacaste">TensorFlow</a>进行文本生成</li>
</ul>
<h2 id="_7"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/217">课后测验</a></h2>
<h2 id="_8">复习与自学</h2>
<p>这里有一些文章可以扩展你的知识</p>
<ul>
<li>不同方法生成文本：马尔可夫链、LSTM和GPT-2: <a href="https://towardsdatascience.com/text-generation-gpt-2-lstm-markov-chain-9ea371820e1e">博文</a></li>
<li><a href="https://keras.io/examples/generative/lstm_character_level_text_generation/">Keras文档</a>中的文本生成示例</li>
</ul>
<h2 id="_9"><a href="../lab/README_chs/">作业</a></h2>
<p>我们已经看到了如何逐字生成文本。在实验中，你将探索词级别的文本生成。</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../16-RNN/README_chs/" class="btn btn-neutral float-left" title="循环神经网络"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../19-NER/README_chs/" class="btn btn-neutral float-right" title="命名实体识别">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../16-RNN/README_chs/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../19-NER/README_chs/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../..";</script>
    <script src="../../../../js/theme_extra.js"></script>
    <script src="../../../../js/theme.js"></script>
      <script src="../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
