<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../../../img/favicon.ico" />
    <title>命名实体识别（NER） - 人工智能初学者课程</title>
    <link rel="stylesheet" href="../../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u547d\u540d\u5b9e\u4f53\u8bc6\u522b\uff08NER\uff09";
        var mkdocs_page_input_path = "lessons/5-NLP/19-NER/lab/README_chs.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../../.." class="icon icon-home"> 人工智能初学者课程
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../../../README_chs/">课程介绍</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">课程设置</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../0-course-setup/for-teachers_chs/">给教育者</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../0-course-setup/how-to-run_chs/">如何运行代码</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../0-course-setup/setup_chs/">开始使用这个课程</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">人工智能简介</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../1-Intro/README_chs/">人工智能简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../1-Intro/assignment_chs/">游戏开发马拉松</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">知识表示与专家系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../2-Symbolic/README_chs/">知识表示与专家系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../2-Symbolic/assignment_chs/">构建一个本体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">神经网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../3-NeuralNetworks/README_chs/">神经网络介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../3-NeuralNetworks/03-Perceptron/README_chs/">神经网络入门：感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../3-NeuralNetworks/04-OwnFramework/README_chs/">神经网络介绍. 多层感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../3-NeuralNetworks/05-Frameworks/README_chs/">神经网络框架</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">计算机视觉</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../4-ComputerVision/06-IntroCV/README_chs/">计算机视觉简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >卷积神经网络</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../../4-ComputerVision/07-ConvNets/CNN_Architectures_chs/">著名的 CNN 架构</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../4-ComputerVision/07-ConvNets/README_chs/">卷积神经网络</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >迁移学习</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../../4-ComputerVision/08-TransferLearning/README_chs/">预训练网络和迁移学习</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../4-ComputerVision/08-TransferLearning/TrainingTricks_chs/">深度学习训练技巧</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../4-ComputerVision/09-Autoencoders/README_chs/">自动编码器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../4-ComputerVision/10-GANs/README_chs/">生成对抗网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../4-ComputerVision/11-ObjectDetection/README_chs/">目标检测</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../4-ComputerVision/12-Segmentation/README_chs/">分割</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自然语言处理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../13-TextRep/README_chs/">将文本表示为张量</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../14-Embeddings/README_chs/">嵌入</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../15-LanguageModeling/README_chs/">语言建模</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../16-RNN/README_chs/">循环神经网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../17-GenerativeNetworks/README_chs/">生成网络</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../18-Transformers/READMEtransformers_chs">注意机制和Transformer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../README_chs/">命名实体识别</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../20-LangModels/READMELargeLang_chs">预训练大语言模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他技术</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../6-Other/21-GeneticAlgorithms/README_chs/">遗传算法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../6-Other/22-DeepRL/README_chs/">深度强化学习</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../6-Other/23-MultiagentSystems/README_chs/">多智能体系统</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">AI伦理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../7-Ethics/README_chs/">道德与负责任的人工智能</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">多模态网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../X-Extras/X1-MultiModal/README_chs/">多模态网络</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../..">人工智能初学者课程</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">命名实体识别（NER）</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ner">命名实体识别（NER）</h1>
<p>来自 <a href="https://github.com/microsoft/ai-for-beginners">AI for Beginners Curriculum</a> 的实验任务。</p>
<h2 id="_1">任务</h2>
<p>在本次实验中，您需要训练一个用于医学术语的命名实体识别模型。</p>
<h2 id="_2">数据集</h2>
<p>要训练 NER 模型，我们需要一个适当标注了医学实体的数据集。<a href="https://biocreative.bioinformatics.udel.edu/tasks/biocreative-v/track-3-cdr/">BC5CDR 数据集</a> 包含了从1500多篇论文中标注的疾病和化学实体。您可以在他们的网站注册后下载数据集。</p>
<p>BC5CDR 数据集如下所示：</p>
<pre><code>6794356|t|新生儿三尖瓣返流和碳酸锂中毒。
6794356|a|描述了一名有大量三尖瓣返流、心房扑动、充血性心力衰竭和高血清锂水平的新生儿。这是第一例最初表现为三尖瓣返流和心房扑动的患者，也是第11例在怀孕早期暴露于锂化合物的婴儿中的具有心脏病的患者。这些婴儿中63％有三尖瓣参与。碳酸锂可能是怀孕早期服用时先天性心脏病发病率增加的因素之一。它在分娩前食用时还会导致神经抑制、青紫症和心律不齐。
6794356 0   29  三尖瓣返流   疾病  D014262
6794356 34  51  碳酸锂 化学品 D016651
6794356 52  60  毒性  疾病  D064420
...
</code></pre>
<p>在这个数据集中，第一行是论文的标题，第二行是摘要，接着是每个独立的实体及其在标题+摘要块中的起始和结束位置。除了实体类型，还会给出该实体在某个医学本体中的本体ID。</p>
<p>您需要编写一些Python代码将其转换为BIO编码格式。</p>
<h2 id="_3">网络</h2>
<p>首次尝试NER可以使用LSTM网络，就像您在课程中看到的例子一样。然而，在NLP任务中，<a href="https://en.wikipedia.org/wiki/Transformer_(machine_learning_model)">转换器架构</a>，尤其是<a href="https://en.wikipedia.org/wiki/BERT_(language_model)">BERT语言模型</a>，显示出更好的结果。预训练的BERT模型理解语言的总体结构，并可以用相对较小的数据集和计算成本进行针对具体任务的微调。</p>
<p>由于我们计划将NER应用于医疗场景，因此使用在医疗文本上训练的BERT模型是有意义的。微软研究院发布了一个预训练模型，称为[PubMedBERT][PubMedBERT]（[发表文章][PubMedBERT-Pub]），该模型使用<a href="https://pubmed.ncbi.nlm.nih.gov/">PubMed</a>库中的文本微调过。</p>
<p>训练转换器模型的事实上的标准是<a href="https://huggingface.co/">Hugging Face Transformers</a>库。它还包含了一个社区维护的预训练模型库，包括PubMedBERT。要加载并使用此模型，我们只需几行代码：</p>
<pre><code class="language-python">model_name = &quot;microsoft/BiomedNLP-PubMedBERT-base-uncased-abstract&quot;
classes = ... # 类别数量：2*实体+1
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = BertForTokenClassification.from_pretrained(model_name, classes)
</code></pre>
<p>这为我们提供了一个 <code>model</code>，它针对标记分类任务构建，使用 <code>classes</code> 数量的类别，还有一个 <code>tokenizer</code> 对象，可以将输入文本拆分为标记。您需要将数据集转换为BIO格式，并考虑PubMedBERT的分词。您可以使用<a href="https://gist.github.com/shwars/580b55684be3328eb39ecf01b9cbbd88">这段Python代码</a>作为灵感。</p>
<h2 id="_4">收获</h2>
<p>这个任务非常接近实际中的任务，如果您想深入分析大量自然语言文本。在我们的案例中，我们可以将我们训练的模型应用于<a href="https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge">与COVID相关的论文数据集</a>，看看我们能得到哪些见解。<a href="https://soshnikov.com/science/analyzing-medical-papers-with-azure-and-text-analytics-for-health/">这篇博客文章</a> 和 <a href="https://www_chs.mdpi.com/2504-2289/6/1/4">这篇论文</a> 描述了使用NER在这批文献语料库上可以进行的研究。</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../../..";</script>
    <script src="../../../../../js/theme_extra.js"></script>
    <script src="../../../../../js/theme.js"></script>
      <script src="../../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
