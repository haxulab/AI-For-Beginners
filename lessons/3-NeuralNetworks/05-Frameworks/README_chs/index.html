<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../../img/favicon.ico" />
    <title>神经网络框架 - 人工智能初学者课程</title>
    <link rel="stylesheet" href="../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u795e\u7ecf\u7f51\u7edc\u6846\u67b6";
        var mkdocs_page_input_path = "lessons/3-NeuralNetworks/05-Frameworks/README_chs.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../.." class="icon icon-home"> 人工智能初学者课程
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../../README_chs/">课程介绍</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">课程设置</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/for-teachers_chs/">给教育者</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/how-to-run_chs/">如何运行代码</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/setup_chs/">开始使用这个课程</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">人工智能简介</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../1-Intro/README_chs/">人工智能简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../1-Intro/assignment_chs/">游戏开发马拉松</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">知识表示与专家系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../2-Symbolic/README_chs/">知识表示与专家系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../2-Symbolic/assignment_chs/">构建一个本体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">神经网络</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../README_chs/">神经网络介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../03-Perceptron/README_chs/">神经网络入门：感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../04-OwnFramework/README_chs/">神经网络介绍. 多层感知器</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">神经网络框架</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">课前测验</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">学习</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_4">✍️ 练习：框架</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">计算机视觉</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/06-IntroCV/README_chs/">计算机视觉简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >卷积神经网络</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../4-ComputerVision/07-ConvNets/CNN_Architectures_chs/">著名的 CNN 架构</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../4-ComputerVision/07-ConvNets/README_chs/">卷积神经网络</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >迁移学习</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../4-ComputerVision/08-TransferLearning/README_chs/">预训练网络和迁移学习</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../4-ComputerVision/08-TransferLearning/TrainingTricks_chs/">深度学习训练技巧</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/09-Autoencoders/README_chs/">自动编码器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/10-GANs/README_chs/">生成对抗网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/11-ObjectDetection/README_chs/">目标检测</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../4-ComputerVision/12-Segmentation/README_chs/">分割</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自然语言处理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/13-TextRep/README_chs/">将文本表示为张量</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/14-Embeddings/README_chs/">嵌入</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/15-LanguageModeling/README_chs/">语言建模</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/16-RNN/README_chs/">循环神经网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/17-GenerativeNetworks/README_chs/">生成网络</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../5-NLP/18-Transformers/READMEtransformers_chs">注意机制和Transformer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/19-NER/README_chs/">命名实体识别</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../5-NLP/20-LangModels/READMELargeLang_chs">预训练大语言模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他技术</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/21-GeneticAlgorithms/README_chs/">遗传算法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/22-DeepRL/README_chs/">深度强化学习</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/23-MultiagentSystems/README_chs/">多智能体系统</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">AI伦理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../7-Ethics/README_chs/">道德与负责任的人工智能</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">多模态网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../X-Extras/X1-MultiModal/README_chs/">多模态网络</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../..">人工智能初学者课程</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">神经网络</li>
      <li class="breadcrumb-item active">神经网络框架</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">神经网络框架</h1>
<p>正如我们已经学习到的，要能够高效地训练神经网络，我们需要做两件事：</p>
<ul>
<li>操作张量，例如相乘、相加和计算一些函数如sigmoid或softmax</li>
<li>计算所有表达式的梯度，以便执行梯度下降优化</li>
</ul>
<h2 id="_2"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/105">课前测验</a></h2>
<p>尽管<code>numpy</code>库可以完成第一部分，但我们仍需要某种机制来计算梯度。在先前章节开发的<a href="../../04-OwnFramework/OwnFramework.ipynb">我们的框架</a>中，我们不得不在<code>backward</code>方法内手动编程所有的导数函数来进行反向传播。理想情况下，一个框架应让我们能够计算<em>任何表达式</em>的梯度。</p>
<p>另一个重要的事情是能够在GPU或任何其他专用计算单元（如<a href="https://en.wikipedia.org/wiki/Tensor_Processing_Unit">TPU</a>）上执行计算。深度神经网络训练需要<em>大量</em>的计算，并且能够在GPU上并行这些计算是非常重要的。</p>
<blockquote>
<p>✅ 术语'并行化'意味着将计算分配到多个设备上。</p>
</blockquote>
<p>目前，最流行的两个神经网络框架是：<a href="http://TensorFlow.org">TensorFlow</a>和<a href="https://pytorch.org/">PyTorch</a>。两者都提供了一个低级API，在CPU和GPU上操作张量。在低级API之上，还有高级API，分别称为<a href="https://keras.io/">Keras</a>和<a href="https://pytorchlightning.ai/">PyTorch Lightning</a>。</p>
<table>
<thead>
<tr>
<th>低级API</th>
<th><a href="http://TensorFlow.org">TensorFlow</a></th>
<th><a href="https://pytorch.org/">PyTorch</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>高级API</td>
<td><a href="https://keras.io/">Keras</a></td>
<td><a href="https://pytorchlightning.ai/">PyTorch Lightning</a></td>
</tr>
</tbody>
</table>
<p><strong>低级API</strong>允许你构建所谓的<strong>计算图</strong>。此图定义了如何利用给定的输入参数计算输出（通常是损失函数），并且如果有GPU可用，可以将其推送到GPU上进行计算。还有一些函数用于求导这个计算图并计算梯度，这些梯度随后可用于优化模型参数。</p>
<p><strong>高级API</strong>基本上将神经网络视为一个<strong>层的序列</strong>，使大多数神经网络的构建变得更容易。训练模型通常需要准备数据，然后调用<code>fit</code>函数来完成这项工作。</p>
<p>高级API允许你非常快速地构建典型的神经网络，而不必担心许多细节。同时，低级API提供了对训练过程更大的控制，因此在研究新神经网络架构时经常使用。</p>
<p>还需要理解的是，你可以共同使用两种API，例如，使用低级API开发自己的网络层架构，然后在用高级API构建和训练的大型网络中使用它。或者你可以使用高级API作为层的序列来定义网络，然后使用自己的低级训练循环来执行优化。两种API使用相同的基本概念，并且设计为能够很好地协作。</p>
<h2 id="_3">学习</h2>
<p>在本课程中，我们提供了大部分内容同时适用于PyTorch和TensorFlow。您可以选择首选的框架，并仅学习相应的笔记本。如果您不确定选择哪个框架，可以阅读一些关于<strong>PyTorch vs. TensorFlow</strong>的讨论。您也可以查看这两个框架以获得更好的理解。</p>
<p>尽可能情况下，我们将使用高级API以求简单。然而，我们认为理解从基础到高级的神经网络工作原理非常重要，因此一开始我们将使用低级API和张量进行工作。然而，如果您希望快速入门并不想花太多时间学习这些细节，您可以跳过这些直接进入高级API笔记本。</p>
<h2 id="_4">✍️ 练习：框架</h2>
<p>在以下笔记本中继续您的学习：</p>
<table>
<thead>
<tr>
<th>低级API</th>
<th><a href="../IntroKerasTF.ipynb">TensorFlow+Keras 笔记本</a></th>
<th><a href="../IntroPyTorch.ipynb">PyTorch</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>高级API</td>
<td><a href="../IntroKeras.ipynb">Keras</a></td>
<td><em>PyTorch Lightning</em></td>
</tr>
</tbody>
</table>
<p>在掌握框架之后，让我们回顾一下过拟合的概念。</p>
<h1 id="_5">过拟合</h1>
<p>过拟合是机器学习中一个极其重要的概念，掌握它非常重要！</p>
<p>考虑以下近似5个点（在下图中由<code>x</code>表示）的问题：</p>
<table>
<thead>
<tr>
<th><img alt="linear" src="../../images/overfit1.jpg" /></th>
<th><img alt="overfit" src="../../images/overfit2.jpg" /></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>线性模型，2个参数</strong></td>
<td><strong>非线性模型，7个参数</strong></td>
</tr>
<tr>
<td>训练误差 = 5.3</td>
<td>训练误差 = 0</td>
</tr>
<tr>
<td>验证误差 = 5.1</td>
<td>验证误差 = 20</td>
</tr>
</tbody>
</table>
<ul>
<li>左边，我们看到一个很好的直线近似。因为参数数量是恰当的，模型正确理解了点的分布。</li>
<li>右边，模型太强大了。因为我们只有5个点，而模型有7个参数，它可以调整以通过所有点，使得训练误差为0。然而，这阻止了模型理解数据背后的正确模式，因此验证误差非常高。</li>
</ul>
<p>在模型的复杂度（参数数量）和训练样本数量之间找到正确的平衡非常重要。</p>
<h2 id="_6">为什么会发生过拟合</h2>
<ul>
<li>训练数据不足</li>
<li>模型太强大</li>
<li>输入数据中噪音过多</li>
</ul>
<h2 id="_7">如何检测过拟合</h2>
<p>正如上图所示，过拟合可以通过非常低的训练误差和高的验证误差来检测。通常在训练过程中，我们会看到训练误差和验证误差都在减少，然后某个时候验证误差可能停止减少并开始上升。这将是过拟合的信号，表明我们应该停止训练（或至少保存模型的快照）。</p>
<p><img alt="overfitting" src="../../images/Overfitting.png" /></p>
<h2 id="_8">如何防止过拟合</h2>
<p>如果你发现过拟合发生了，你可以采取以下措施之一：</p>
<ul>
<li>增加训练数据量</li>
<li>减少模型的复杂度</li>
<li>使用某种<a href="../../../4-ComputerVision/08-TransferLearning/TrainingTricks_chs/">正则化技术</a>，例如<a href="../../../4-ComputerVision/08-TransferLearning/TrainingTricks_chs/#Dropout">Dropout</a>，我们稍后会考虑这些技术。</li>
</ul>
<h2 id="-">过拟合和偏差-方差权衡</h2>
<p>过拟合实际上是统计学中的一种更通用的问题，称为<a href="https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff">偏差-方差权衡</a>。如果我们考虑模型中可能的错误来源，我们可以看到两种类型的错误：</p>
<ul>
<li><strong>偏差错误</strong>，由我们的算法未能正确捕捉训练数据之间的关系引起。它可能是由于我们的模型不够强大（<strong>欠拟合</strong>）造成的。</li>
<li><strong>方差错误</strong>，由模型近似输入数据中的噪声而不是有意义的关系引起（<strong>过拟合</strong>）。</li>
</ul>
<p>在训练过程中，偏差错误减少（因为我们的模型学会近似数据），而方差错误增加。重要的是在发现过拟合时停止训练 - 无论是手动还是自动（通过引入正则化） - 以防止过拟合。</p>
<h2 id="_9">结论</h2>
<p>在本课中，您了解了两个最流行的AI框架TensorFlow和PyTorch的不同API。此外，您还了解了一个非常重要的主题，过拟合。</p>
<h2 id="_10">🚀 挑战</h2>
<p>在配套的笔记本中，您将在底部找到“任务”；请完成笔记本中的任务。</p>
<h2 id="_11"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/205">课后测验</a></h2>
<h2 id="_12">复习与自学</h2>
<p>对以下主题进行一些研究：</p>
<ul>
<li>TensorFlow</li>
<li>PyTorch</li>
<li>过拟合</li>
</ul>
<p>问自己以下问题：</p>
<ul>
<li>TensorFlow和PyTorch的区别是什么？</li>
<li>过拟合和欠拟合的区别是什么？</li>
</ul>
<h2 id="_13"><a href="../lab/README_chs/">作业</a></h2>
<p>在本实验中，您需要使用PyTorch或TensorFlow解决两个分类问题，使用单层和多层完全连接的网络。</p>
<ul>
<li><a href="../lab/README_chs/">说明</a></li>
<li><a href="../lab/LabFrameworks.ipynb">笔记本</a></li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../04-OwnFramework/README_chs/" class="btn btn-neutral float-left" title="神经网络介绍. 多层感知器"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../../4-ComputerVision/06-IntroCV/README_chs/" class="btn btn-neutral float-right" title="计算机视觉简介">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../04-OwnFramework/README_chs/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../../4-ComputerVision/06-IntroCV/README_chs/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../..";</script>
    <script src="../../../../js/theme_extra.js"></script>
    <script src="../../../../js/theme.js"></script>
      <script src="../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
