<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../../img/favicon.ico" />
    <title>自动编码器 - 人工智能初学者课程</title>
    <link rel="stylesheet" href="../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u81ea\u52a8\u7f16\u7801\u5668";
        var mkdocs_page_input_path = "lessons/4-ComputerVision/09-Autoencoders/README_chs.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../.." class="icon icon-home"> 人工智能初学者课程
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../../README_chs/">课程介绍</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">课程设置</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/for-teachers_chs/">给教育者</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/how-to-run_chs/">如何运行代码</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../0-course-setup/setup_chs/">开始使用这个课程</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">人工智能简介</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../1-Intro/README_chs/">人工智能简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../1-Intro/assignment_chs/">游戏开发马拉松</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">知识表示与专家系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../2-Symbolic/README_chs/">知识表示与专家系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../2-Symbolic/assignment_chs/">构建一个本体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">神经网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../3-NeuralNetworks/README_chs/">神经网络介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../3-NeuralNetworks/03-Perceptron/README_chs/">神经网络入门：感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../3-NeuralNetworks/04-OwnFramework/README_chs/">神经网络介绍. 多层感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../3-NeuralNetworks/05-Frameworks/README_chs/">神经网络框架</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">计算机视觉</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../06-IntroCV/README_chs/">计算机视觉简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >卷积神经网络</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../07-ConvNets/CNN_Architectures_chs/">著名的 CNN 架构</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../07-ConvNets/README_chs/">卷积神经网络</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >迁移学习</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../08-TransferLearning/README_chs/">预训练网络和迁移学习</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../08-TransferLearning/TrainingTricks_chs/">深度学习训练技巧</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">自动编码器</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">课前测验</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">使用自动编码器的场景</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#vae">变分自动编码器 (VAE)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_4">✍️ 练习：自动编码器</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_5">自动编码器的属性</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_6">课后测验</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_7">总结</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_8">🚀 挑战</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_9">课后测验</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_10">复习与自学</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_11">作业</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../10-GANs/README_chs/">生成对抗网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../11-ObjectDetection/README_chs/">目标检测</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../12-Segmentation/README_chs/">分割</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自然语言处理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/13-TextRep/README_chs/">将文本表示为张量</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/14-Embeddings/README_chs/">嵌入</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/15-LanguageModeling/README_chs/">语言建模</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/16-RNN/README_chs/">循环神经网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/17-GenerativeNetworks/README_chs/">生成网络</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../5-NLP/18-Transformers/READMEtransformers_chs">注意机制和Transformer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-NLP/19-NER/README_chs/">命名实体识别</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../5-NLP/20-LangModels/READMELargeLang_chs">预训练大语言模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他技术</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/21-GeneticAlgorithms/README_chs/">遗传算法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/22-DeepRL/README_chs/">深度强化学习</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../6-Other/23-MultiagentSystems/README_chs/">多智能体系统</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">AI伦理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../7-Ethics/README_chs/">道德与负责任的人工智能</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">多模态网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../X-Extras/X1-MultiModal/README_chs/">多模态网络</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../..">人工智能初学者课程</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">计算机视觉</li>
      <li class="breadcrumb-item active">自动编码器</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">自动编码器</h1>
<p>在训练 CNN 时，其中一个问题是我们需要大量标记数据。在图像分类的情况下，我们需要将图像分为不同的类别，这需要手动操作。</p>
<h2 id="_2"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/109">课前测验</a></h2>
<p>然而，我们可能希望使用原始（未标记）数据来训练 CNN 特征提取器，这称为<strong>自监督学习</strong>。我们将使用训练图像作为网络的输入和输出。<strong>自动编码器</strong>的主要思想是我们将有一个<strong>编码器网络</strong>，将输入图像转换为某种<strong>潜在空间</strong>（通常它只是一个较小尺寸的向量），然后<strong>解码器网络</strong>的目标是重建原始图像。</p>
<blockquote>
<p>✅ <a href="https://wikipedia.org/wiki/Autoencoder">自动编码器</a> 是“一种用于学习无标签数据的有效编码的人工神经网络类型。”</p>
</blockquote>
<p>由于我们训练的是一个自动编码器来尽可能多地捕获原始图像中的信息，以实现精确的重建，网络尝试找到输入图像的最佳<strong>嵌入</strong>来捕获其含义。</p>
<p><img alt="AutoEncoder Diagram" src="../images/autoencoder_schema.jpg" /></p>
<blockquote>
<p>图片来自 <a href="https://blog.keras.io/building-autoencoders-in-keras.html">Keras 博客</a></p>
</blockquote>
<h2 id="_3">使用自动编码器的场景</h2>
<p>尽管重建原始图像本身看起来没有多大用处，但在某些情况下，自动编码器特别有用：</p>
<ul>
<li><strong>降低图像的维度用于可视化</strong>或<strong>训练图像嵌入</strong>。通常自动编码器比 PCA 结果更好，因为它考虑了图像的空间性质和层次特征。</li>
<li><strong>去噪</strong>，即去除图像中的噪点。因为噪点携带了大量无用信息，自动编码器无法将其全部塞入相对较小的潜在空间，因此它只捕获图像的重要部分。在训练去噪器时，我们从原始图像开始，并使用人工添加噪点的图像作为自动编码器的输入。</li>
<li><strong>超分辨率</strong>，增加图像分辨率。我们从高分辨率图像开始，使用低分辨率图像作为自动编码器的输入。</li>
<li><strong>生成模型</strong>。一旦我们训练了自动编码器，解码器部分可以用于从随机潜在向量开始创建新对象。</li>
</ul>
<h2 id="vae">变分自动编码器 (VAE)</h2>
<p>传统的自动编码器以某种方式降低输入数据的维度，找出输入图像的重要特征。然而，潜在向量往往没有多大意义。换句话说，以 MNIST 数据集为例，弄清楚哪些数字对应不同的潜在向量并非易事，因为接近的潜在向量不一定对应于相同的数字。</p>
<p>另一方面，要训练<em>生成</em>模型，了解潜在空间会更有帮助。这一想法引导我们到 <strong>变分自动编码器</strong> (VAE)。</p>
<p>VAE 是一种学习预测<em>潜在参数</em>的<em>统计分布</em>的自动编码器，即所谓的<strong>潜在分布</strong>。例如，我们可能希望潜在向量按照某种均值 z<sub>mean</sub> 和标准偏差 z<sub>sigma</sub>（均值和标准差都是某个维度 d 的向量）正常分布。VAE 中的编码器学习预测这些参数，然后解码器从这个分布中抽取一个随机向量来重建对象。</p>
<p>总结：</p>
<ul>
<li>从输入向量中，我们预测 <code>z_mean</code> 和 <code>z_log_sigma</code>（我们预测其对数而不是标准偏差本身）</li>
<li>我们从分布 N(z<sub>mean</sub>,exp(z<sub>log_sigma</sub>)) 中抽取一个向量 <code>sample</code></li>
<li>解码器尝试使用 <code>sample</code> 作为输入向量解码原始图像</li>
</ul>
<p><img alt="VAE" src="../images/vae.png" /></p>
<blockquote>
<p>图片来自 <a href="https://ijdykeman.github.io/ml/2016/12/21/cvae.html">这个博客帖子</a> 由 Isaak Dykeman 撰写</p>
</blockquote>
<p>变分自动编码器使用一个由两个部分组成的复杂损失函数：</p>
<ul>
<li><strong>重建损失</strong>是展示重建图像与目标图像接近程度的损失函数（可以是均方误差，或 MSE）。它与普通自动编码器中的损失函数相同。</li>
<li><strong>KL 损失</strong>确保潜在变量分布保持接近正态分布。它基于 <a href="https://www.countbayesie.com/blog/2017/5/9/kullback-leibler-divergence-explained">Kullback-Leibler 散度</a> 概念 - 一种估计两个统计分布相似程度的度量。</li>
</ul>
<p>VAE 的一个重要优点是我们可以相对轻松地生成新图像，因为我们知道从何种分布中抽取潜在向量。例如，如果我们在 MNIST 上训练带有 2D 潜在向量的 VAE，我们可以随着潜在向量组件的变化得到不同的数字：</p>
<p><img alt="vaemnist" src="../images/vaemnist.png" /></p>
<blockquote>
<p>图片由 <a href="http://soshnikov.com">Dmitry Soshnikov</a> 提供</p>
</blockquote>
<p>观察如何图像相互融合，因为我们开始从潜在参数空间的不同部分获取潜在向量。我们还可以在 2D 中可视化此空间：</p>
<p><img alt="vaemnist cluster" src="../images/vaemnist-diag.png" /></p>
<blockquote>
<p>图片由 <a href="http://soshnikov.com">Dmitry Soshnikov</a> 提供</p>
</blockquote>
<h2 id="_4">✍️ 练习：自动编码器</h2>
<p>在这些相应的笔记本中了解更多关于自动编码器的知识：</p>
<ul>
<li><a href="../AutoencodersTF.ipynb">TensorFlow 中的自动编码器</a></li>
<li><a href="../AutoEncodersPyTorch.ipynb">PyTorch 中的自动编码器</a></li>
</ul>
<h2 id="_5">自动编码器的属性</h2>
<ul>
<li><strong>数据特定化</strong> - 它们只能很好地处理训练过的图像类型。例如，如果我们在花卉上训练一个超分辨率网络，它在肖像上效果不会很好。这是因为网络可以通过从训练数据集中学得的特征中获取细节来生成更高分辨率的图像。</li>
<li><strong>有损</strong> - 重建的图像与原始图像不同。损失的性质由训练过程中使用的<em>损失函数</em>决定</li>
<li>适用于 <strong>无标记数据</strong></li>
</ul>
<h2 id="_6"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/209">课后测验</a></h2>
<h2 id="_7">总结</h2>
<p>在本课中，您了解了 AI 科学家可用的各种类型的自动编码器。您学习了如何构建它们，并如何使用它们重建图像。您还学习了 VAE 以及如何使用它来生成新图像。</p>
<h2 id="_8">🚀 挑战</h2>
<p>在本课中，您学习了如何使用自动编码器处理图像。但它们也可以用于音乐！查看 Magenta 项目的 <a href="https://magenta.tensorflow.org/music-vae">MusicVAE</a> 项目，该项目使用自动编码器学习重建音乐。使用此库进行一些<a href="https://colab.research.google.com/github/magenta/magenta-demos/blob/master/colab-notebooks/Multitrack_MusicVAE.ipynb">实验</a> 来看看您能创作出什么。</p>
<h2 id="_9"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/208">课后测验</a></h2>
<h2 id="_10">复习与自学</h2>
<p>作为参考，请阅读更多关于自动编码器的资源：</p>
<ul>
<li><a href="https://blog.keras.io/building-autoencoders-in-keras.html">在 Keras 中构建自动编码器</a></li>
<li><a href="https://neurohive.io/ru/osnovy-data-science/variacionnyj-avtojenkoder-vae/">NeuroHive 上的博客文章</a></li>
<li><a href="https://kvfrans.com/variational-autoencoders-explained/">变分自动编码器详解</a></li>
<li><a href="https://ijdykeman.github.io/ml/2016/12/21/cvae.html">条件变分自动编码器</a></li>
</ul>
<h2 id="_11">作业</h2>
<p>在 <a href="../AutoencodersTF.ipynb">此使用 TensorFlow 的笔记本</a> 的末尾，您会发现一个“任务” - 使用它作为您的作业。</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../08-TransferLearning/TrainingTricks_chs/" class="btn btn-neutral float-left" title="深度学习训练技巧"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../10-GANs/README_chs/" class="btn btn-neutral float-right" title="生成对抗网络">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../08-TransferLearning/TrainingTricks_chs/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../10-GANs/README_chs/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../..";</script>
    <script src="../../../../js/theme_extra.js"></script>
    <script src="../../../../js/theme.js"></script>
      <script src="../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
