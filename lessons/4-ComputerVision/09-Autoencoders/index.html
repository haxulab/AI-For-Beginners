<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Autoencoders - 人工智能初学者课程</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Autoencoders";
        var mkdocs_page_input_path = "lessons/4-ComputerVision/09-Autoencoders/README.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> 人工智能初学者课程
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../README_chs/">课程介绍</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">课程设置</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../0-course-setup/for-teachers_chs/">给教育者</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../0-course-setup/how-to-run_chs/">如何运行代码</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../0-course-setup/setup_chs/">开始使用这个课程</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">人工智能简介</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../1-Intro/README_chs/">人工智能简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../1-Intro/assignment_chs/">游戏开发马拉松</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">知识表示与专家系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../2-Symbolic/README_chs/">知识表示与专家系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../2-Symbolic/assignment_chs/">构建一个本体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">神经网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../3-NeuralNetworks/README_chs/">神经网络介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../3-NeuralNetworks/03-Perceptron/README_chs/">神经网络入门：感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../3-NeuralNetworks/04-OwnFramework/README_chs/">神经网络介绍. 多层感知器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../3-NeuralNetworks/05-Frameworks/README_chs/">神经网络框架</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">计算机视觉</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../06-IntroCV/README_chs/">计算机视觉简介</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >卷积神经网络</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../07-ConvNets/CNN_Architectures_chs/">著名的 CNN 架构</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../07-ConvNets/README_chs/">卷积神经网络</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >迁移学习</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../08-TransferLearning/README_chs/">预训练网络和迁移学习</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../08-TransferLearning/TrainingTricks_chs/">深度学习训练技巧</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="README_chs/">自动编码器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../10-GANs/README_chs/">生成对抗网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../11-ObjectDetection/README_chs/">目标检测</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../12-Segmentation/README_chs/">分割</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自然语言处理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../5-NLP/13-TextRep/README_chs/">将文本表示为张量</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../5-NLP/14-Embeddings/README_chs/">嵌入</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../5-NLP/15-LanguageModeling/README_chs/">语言建模</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../5-NLP/16-RNN/README_chs/">循环神经网络</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../5-NLP/17-GenerativeNetworks/README_chs/">生成网络</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../5-NLP/18-Transformers/READMEtransformers_chs">注意机制和Transformer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../5-NLP/19-NER/README_chs/">命名实体识别</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../5-NLP/20-LangModels/READMELargeLang_chs">预训练大语言模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他技术</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../6-Other/21-GeneticAlgorithms/README_chs/">遗传算法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../6-Other/22-DeepRL/README_chs/">深度强化学习</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../6-Other/23-MultiagentSystems/README_chs/">多智能体系统</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">AI伦理</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../7-Ethics/README_chs/">道德与负责任的人工智能</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">多模态网络</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../X-Extras/X1-MultiModal/README_chs/">多模态网络</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">人工智能初学者课程</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Autoencoders</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="autoencoders">Autoencoders</h1>
<p>When training CNNs, one of the problems is that we need a lot of labeled data. In the case of image classification, we need to separate images into different classes, which is a manual effort.</p>
<h2 id="pre-lecture-quiz"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/109">Pre-lecture quiz</a></h2>
<p>However, we might want to use raw (unlabeled) data for training CNN feature extractors, which is called <strong>self-supervised learning</strong>. Instead of labels, we will use training images as both network input and output. The main idea of <strong>autoencoder</strong> is that we will have an <strong>encoder network</strong> that converts input image into some <strong>latent space</strong> (normally it is just a vector of some smaller size), then the <strong>decoder network</strong>, whose goal would be to reconstruct the original image.</p>
<blockquote>
<p>✅ An <a href="https://wikipedia.org/wiki/Autoencoder">autoencoder</a> is "a type of artificial neural network used to learn efficient codings of unlabeled data."</p>
</blockquote>
<p>Since we are training an autoencoder to capture as much of the information from the original image as possible for accurate reconstruction, the network tries to find the best <strong>embedding</strong> of input images to capture the meaning.л.</p>
<p><img alt="AutoEncoder Diagram" src="images/autoencoder_schema.jpg" /></p>
<blockquote>
<p>Image from <a href="https://blog.keras.io/building-autoencoders-in-keras.html">Keras blog</a></p>
</blockquote>
<h2 id="scenarios-for-using-autoencoders">Scenarios for using Autoencoders</h2>
<p>While reconstructing original images does not seem useful in its own right, there are a few scenarios where autoencoders are especially useful:</p>
<ul>
<li><strong>Lowering the dimension of images for visualization</strong> or <strong>training image embeddings</strong>. Usually autoencoders give better results than PCA, because it takes into account spatial nature of images and hierarchical features.</li>
<li><strong>Denoising</strong>, i.e. removing noise from the image. Because noise carries out a lot of useless information, autoencoder cannot fit it all into relatively small latent space, and thus it captures only important part of the image. When training denoisers, we start with original images, and use images with artificially added noise as input for autoencoder.</li>
<li><strong>Super-resolution</strong>, increasing image resolution. We start with high-resolution images, and use the image with lower resolution as the autoencoder input.</li>
<li><strong>Generative models</strong>. Once we train the autoencoder, the decoder part can be used to create new objects starting from random latent vectors.</li>
</ul>
<h2 id="variational-autoencoders-vae">Variational Autoencoders (VAE)</h2>
<p>Traditional autoencoders reduce the dimension of the input data somehow, figuring out the important features of input images. However, latent vectors ofter do not make much sense. In other words, taking MNIST dataset as an example, figuring out which digits correspond to different latent vectors is not an easy task, because close latent vectors would not necessarily correspond to the same digits.</p>
<p>On the other hand, to train <em>generative</em> models it is better to have some understanding of the latent space. This idea leads us to <strong>variational auto-encoder</strong> (VAE).</p>
<p>VAE is the autoencoder that learns to predict <em>statistical distribution</em> of the latent parameters, so-called <strong>latent distribution</strong>. For example, we may want latent vectors to be distributed normally with some mean z<sub>mean</sub> and standard deviation z<sub>sigma</sub> (both mean and standard deviation are vectors of some dimensionality d). Encoder in VAE learns to predict those parameters, and then decoder takes a random vector from this distribution to reconstruct the object.</p>
<p>To summarize:</p>
<ul>
<li>From input vector, we predict <code>z_mean</code> and <code>z_log_sigma</code> (instead of predicting the standard deviation itself, we predict its logarithm)</li>
<li>We sample a vector <code>sample</code> from the distribution N(z<sub>mean</sub>,exp(z<sub>log_sigma</sub>))</li>
<li>The decoder tries to decode the original image using <code>sample</code> as an input vector</li>
</ul>
<p><img src="images/vae.png" width="50%"></p>
<blockquote>
<p>Image from <a href="https://ijdykeman.github.io/ml/2016/12/21/cvae.html">this blog post</a> by Isaak Dykeman</p>
</blockquote>
<p>Variational auto-encoders use a complex loss function that consists of two parts:</p>
<ul>
<li><strong>Reconstruction loss</strong> is the loss function that shows how close a reconstructed image is to the target (it can be Mean Squared Error, or MSE). It is the same loss function as in normal autoencoders.</li>
<li><strong>KL loss</strong>, which ensures that latent variable distributions stays close to normal distribution. It is based on the notion of <a href="https://www.countbayesie.com/blog/2017/5/9/kullback-leibler-divergence-explained">Kullback-Leibler divergence</a> - a metric to estimate how similar two statistical distributions are.</li>
</ul>
<p>One important advantage of VAEs is that they allow us to generate new images relatively easily, because we know which distribution from which to sample latent vectors. For example, if we train VAE with 2D latent vector on MNIST, we can then vary components of the latent vector to get different digits:</p>
<p><img alt="vaemnist" src="images/vaemnist.png" width="50%"/></p>
<blockquote>
<p>Image by <a href="http://soshnikov.com">Dmitry Soshnikov</a></p>
</blockquote>
<p>Observe how images blend into each other, as we start getting latent vectors from the different portions of the latent parameter space. We can also visualize this space in 2D:</p>
<p><img alt="vaemnist cluster" src="images/vaemnist-diag.png" width="50%"/> </p>
<blockquote>
<p>Image by <a href="http://soshnikov.com">Dmitry Soshnikov</a></p>
</blockquote>
<h2 id="exercises-autoencoders">✍️ Exercises: Autoencoders</h2>
<p>Learn more about autoencoders in these corresponding notebooks:</p>
<ul>
<li><a href="AutoencodersTF.ipynb">Autoencoders in TensorFlow</a></li>
<li><a href="AutoEncodersPyTorch.ipynb">Autoencoders in PyTorch</a></li>
</ul>
<h2 id="properties-of-autoencoders">Properties of Autoencoders</h2>
<ul>
<li><strong>Data Specific</strong> - they only work well with the type of images they have been trained on. For example, if we train a super-resolution network on flowers, it will not work well on portraits. This is because the network can produce higher resolution image by taking fine details from features learned from the training dataset.</li>
<li><strong>Lossy</strong> - the reconstructed image is not the same as the original image. The nature of loss is defined by the <em>loss function</em> used during training</li>
<li>Works on <strong>unlabeled data</strong></li>
</ul>
<h2 id="post-lecture-quiz"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/209">Post-lecture quiz</a></h2>
<h2 id="conclusion">Conclusion</h2>
<p>In this lesson, you learned about the various types of autoencoders available to the AI scientist. You learned how to build them, and how to use them to reconstruct images. You also learned about the VAE and how to use it to generate new images.</p>
<h2 id="challenge">🚀 Challenge</h2>
<p>In this lesson, you learned about using autoencoders for images. But they can also be used for music! Check out the Magenta project's <a href="https://magenta.tensorflow.org/music-vae">MusicVAE</a> project, which uses autoencoders to learn to reconstruct music. Do some <a href="https://colab.research.google.com/github/magenta/magenta-demos/blob/master/colab-notebooks/Multitrack_MusicVAE.ipynb">experiments</a> with this library to see what you can create.</p>
<h2 id="post-lecture-quiz_1"><a href="https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/208">Post-lecture quiz</a></h2>
<h2 id="review-self-study">Review &amp; Self Study</h2>
<p>For reference, read more about autoencoders in these resources:</p>
<ul>
<li><a href="https://blog.keras.io/building-autoencoders-in-keras.html">Building Autoencoders in Keras</a></li>
<li><a href="https://neurohive.io/ru/osnovy-data-science/variacionnyj-avtojenkoder-vae/">Blog post on NeuroHive</a></li>
<li><a href="https://kvfrans.com/variational-autoencoders-explained/">Variational Autoencoders Explained</a></li>
<li><a href="https://ijdykeman.github.io/ml/2016/12/21/cvae.html">Conditional Variational Autoencoders</a></li>
</ul>
<h2 id="assignment">Assignment</h2>
<p>At the end of <a href="AutoencodersTF.ipynb">this notebook using TensorFlow</a>, you will find a 'task' - use this as your assignment.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
